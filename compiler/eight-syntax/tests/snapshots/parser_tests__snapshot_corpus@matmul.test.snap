---
source: compiler/eight-syntax/tests/parser_tests.rs
expression: translation_unit
input_file: compiler/eight-syntax/tests/data/matmul.test
snapshot_kind: text
---
AstTranslationUnit(
  items: [
    Type(AstTypeItem(
      span: Span(
        low: 0,
        high: 50,
      ),
      name: AstIdentifier(
        name: "Matrix",
        span: Span(
          low: 5,
          high: 11,
        ),
      ),
      members: [
        AstTypeMemberItem(
          span: Span(
            low: 18,
            high: 25,
          ),
          name: AstIdentifier(
            name: "r",
            span: Span(
              low: 18,
              high: 19,
            ),
          ),
          type: Integer32(AstInteger32Type(
            span: Span(
              low: 21,
              high: 24,
            ),
          )),
        ),
        AstTypeMemberItem(
          span: Span(
            low: 28,
            high: 35,
          ),
          name: AstIdentifier(
            name: "c",
            span: Span(
              low: 28,
              high: 29,
            ),
          ),
          type: Integer32(AstInteger32Type(
            span: Span(
              low: 31,
              high: 34,
            ),
          )),
        ),
        AstTypeMemberItem(
          span: Span(
            low: 38,
            high: 48,
          ),
          name: AstIdentifier(
            name: "buf",
            span: Span(
              low: 38,
              high: 41,
            ),
          ),
          type: Pointer(AstPointerType(
            span: Span(
              low: 43,
              high: 47,
            ),
            inner: Integer32(AstInteger32Type(
              span: Span(
                low: 44,
                high: 47,
              ),
            )),
          )),
        ),
      ],
    )),
    Function(AstFunctionItem(
      span: Span(
        low: 52,
        high: 466,
      ),
      name: AstIdentifier(
        name: "matrix_matrix_multiply",
        span: Span(
          low: 55,
          high: 77,
        ),
      ),
      parameters: [
        AstFunctionParameterItem(
          span: Span(
            low: 78,
            high: 87,
          ),
          name: AstIdentifier(
            name: "a",
            span: Span(
              low: 78,
              high: 79,
            ),
          ),
          type: Named(AstNamedType(
            span: Span(
              low: 81,
              high: 87,
            ),
            name: AstIdentifier(
              name: "Matrix",
              span: Span(
                low: 81,
                high: 87,
              ),
            ),
          )),
        ),
        AstFunctionParameterItem(
          span: Span(
            low: 89,
            high: 98,
          ),
          name: AstIdentifier(
            name: "b",
            span: Span(
              low: 89,
              high: 90,
            ),
          ),
          type: Named(AstNamedType(
            span: Span(
              low: 92,
              high: 98,
            ),
            name: AstIdentifier(
              name: "Matrix",
              span: Span(
                low: 92,
                high: 98,
              ),
            ),
          )),
        ),
      ],
      type_parameters: [],
      return_type: Some(Named(AstNamedType(
        span: Span(
          low: 103,
          high: 109,
        ),
        name: AstIdentifier(
          name: "Matrix",
          span: Span(
            low: 103,
            high: 109,
          ),
        ),
      ))),
      body: [
        Let(AstLetStmt(
          span: Span(
            low: 114,
            high: 195,
          ),
          name: AstIdentifier(
            name: "c",
            span: Span(
              low: 118,
              high: 119,
            ),
          ),
          type: None,
          value: Construct(AstConstructExpr(
            span: Span(
              low: 122,
              high: 194,
            ),
            callee: Named(AstNamedType(
              span: Span(
                low: 126,
                high: 132,
              ),
              name: AstIdentifier(
                name: "Matrix",
                span: Span(
                  low: 126,
                  high: 132,
                ),
              ),
            )),
            arguments: [
              AstConstructorExprArgument(
                span: Span(
                  low: 139,
                  high: 145,
                ),
                field: AstIdentifier(
                  name: "r",
                  span: Span(
                    low: 139,
                    high: 140,
                  ),
                ),
                expr: DotIndex(AstDotIndexExpr(
                  span: Span(
                    low: 142,
                    high: 145,
                  ),
                  origin: Reference(AstReferenceExpr(
                    span: Span(
                      low: 142,
                      high: 143,
                    ),
                    name: AstIdentifier(
                      name: "a",
                      span: Span(
                        low: 142,
                        high: 143,
                      ),
                    ),
                  )),
                  index: AstIdentifier(
                    name: "r",
                    span: Span(
                      low: 144,
                      high: 145,
                    ),
                  ),
                )),
              ),
              AstConstructorExprArgument(
                span: Span(
                  low: 151,
                  high: 157,
                ),
                field: AstIdentifier(
                  name: "c",
                  span: Span(
                    low: 151,
                    high: 152,
                  ),
                ),
                expr: DotIndex(AstDotIndexExpr(
                  span: Span(
                    low: 154,
                    high: 157,
                  ),
                  origin: Reference(AstReferenceExpr(
                    span: Span(
                      low: 154,
                      high: 155,
                    ),
                    name: AstIdentifier(
                      name: "b",
                      span: Span(
                        low: 154,
                        high: 155,
                      ),
                    ),
                  )),
                  index: AstIdentifier(
                    name: "c",
                    span: Span(
                      low: 156,
                      high: 157,
                    ),
                  ),
                )),
              ),
              AstConstructorExprArgument(
                span: Span(
                  low: 163,
                  high: 189,
                ),
                field: AstIdentifier(
                  name: "buf",
                  span: Span(
                    low: 163,
                    high: 166,
                  ),
                ),
                expr: Call(AstCallExpr(
                  span: Span(
                    low: 168,
                    high: 189,
                  ),
                  callee: Reference(AstReferenceExpr(
                    span: Span(
                      low: 168,
                      high: 174,
                    ),
                    name: AstIdentifier(
                      name: "malloc",
                      span: Span(
                        low: 168,
                        high: 174,
                      ),
                    ),
                  )),
                  arguments: [
                    BinaryOp(AstBinaryOpExpr(
                      span: Span(
                        low: 175,
                        high: 188,
                      ),
                      lhs: DotIndex(AstDotIndexExpr(
                        span: Span(
                          low: 175,
                          high: 178,
                        ),
                        origin: Reference(AstReferenceExpr(
                          span: Span(
                            low: 175,
                            high: 176,
                          ),
                          name: AstIdentifier(
                            name: "a",
                            span: Span(
                              low: 175,
                              high: 176,
                            ),
                          ),
                        )),
                        index: AstIdentifier(
                          name: "r",
                          span: Span(
                            low: 177,
                            high: 178,
                          ),
                        ),
                      )),
                      rhs: BinaryOp(AstBinaryOpExpr(
                        span: Span(
                          low: 181,
                          high: 188,
                        ),
                        lhs: DotIndex(AstDotIndexExpr(
                          span: Span(
                            low: 181,
                            high: 184,
                          ),
                          origin: Reference(AstReferenceExpr(
                            span: Span(
                              low: 181,
                              high: 182,
                            ),
                            name: AstIdentifier(
                              name: "b",
                              span: Span(
                                low: 181,
                                high: 182,
                              ),
                            ),
                          )),
                          index: AstIdentifier(
                            name: "c",
                            span: Span(
                              low: 183,
                              high: 184,
                            ),
                          ),
                        )),
                        rhs: IntegerLiteral(AstIntegerLiteralExpr(
                          span: Span(
                            low: 187,
                            high: 188,
                          ),
                          value: 4,
                        )),
                        op: Mul,
                      )),
                      op: Mul,
                    )),
                  ],
                  type_arguments: [],
                )),
              ),
            ],
          )),
        )),
        For(AstForStmt(
          span: Span(
            low: 199,
            high: 452,
          ),
          initializer: Some(AstForStmtInitializer(
            span: Span(
              low: 204,
              high: 213,
            ),
            name: AstIdentifier(
              name: "i",
              span: Span(
                low: 208,
                high: 209,
              ),
            ),
            initializer: IntegerLiteral(AstIntegerLiteralExpr(
              span: Span(
                low: 212,
                high: 213,
              ),
              value: 0,
            )),
          )),
          condition: Some(BinaryOp(AstBinaryOpExpr(
            span: Span(
              low: 215,
              high: 222,
            ),
            lhs: Reference(AstReferenceExpr(
              span: Span(
                low: 215,
                high: 216,
              ),
              name: AstIdentifier(
                name: "i",
                span: Span(
                  low: 215,
                  high: 216,
                ),
              ),
            )),
            rhs: DotIndex(AstDotIndexExpr(
              span: Span(
                low: 219,
                high: 222,
              ),
              origin: Reference(AstReferenceExpr(
                span: Span(
                  low: 219,
                  high: 220,
                ),
                name: AstIdentifier(
                  name: "a",
                  span: Span(
                    low: 219,
                    high: 220,
                  ),
                ),
              )),
              index: AstIdentifier(
                name: "r",
                span: Span(
                  low: 221,
                  high: 222,
                ),
              ),
            )),
            op: Lt,
          ))),
          increment: Some(Assign(AstAssignExpr(
            span: Span(
              low: 224,
              high: 233,
            ),
            lhs: Reference(AstReferenceExpr(
              span: Span(
                low: 224,
                high: 225,
              ),
              name: AstIdentifier(
                name: "i",
                span: Span(
                  low: 224,
                  high: 225,
                ),
              ),
            )),
            rhs: BinaryOp(AstBinaryOpExpr(
              span: Span(
                low: 228,
                high: 233,
              ),
              lhs: Reference(AstReferenceExpr(
                span: Span(
                  low: 228,
                  high: 229,
                ),
                name: AstIdentifier(
                  name: "i",
                  span: Span(
                    low: 228,
                    high: 229,
                  ),
                ),
              )),
              rhs: IntegerLiteral(AstIntegerLiteralExpr(
                span: Span(
                  low: 232,
                  high: 233,
                ),
                value: 1,
              )),
              op: Add,
            )),
          ))),
          body: [
            For(AstForStmt(
              span: Span(
                low: 241,
                high: 448,
              ),
              initializer: Some(AstForStmtInitializer(
                span: Span(
                  low: 246,
                  high: 255,
                ),
                name: AstIdentifier(
                  name: "j",
                  span: Span(
                    low: 250,
                    high: 251,
                  ),
                ),
                initializer: IntegerLiteral(AstIntegerLiteralExpr(
                  span: Span(
                    low: 254,
                    high: 255,
                  ),
                  value: 0,
                )),
              )),
              condition: Some(BinaryOp(AstBinaryOpExpr(
                span: Span(
                  low: 257,
                  high: 264,
                ),
                lhs: Reference(AstReferenceExpr(
                  span: Span(
                    low: 257,
                    high: 258,
                  ),
                  name: AstIdentifier(
                    name: "j",
                    span: Span(
                      low: 257,
                      high: 258,
                    ),
                  ),
                )),
                rhs: DotIndex(AstDotIndexExpr(
                  span: Span(
                    low: 261,
                    high: 264,
                  ),
                  origin: Reference(AstReferenceExpr(
                    span: Span(
                      low: 261,
                      high: 262,
                    ),
                    name: AstIdentifier(
                      name: "b",
                      span: Span(
                        low: 261,
                        high: 262,
                      ),
                    ),
                  )),
                  index: AstIdentifier(
                    name: "c",
                    span: Span(
                      low: 263,
                      high: 264,
                    ),
                  ),
                )),
                op: Lt,
              ))),
              increment: Some(Assign(AstAssignExpr(
                span: Span(
                  low: 266,
                  high: 275,
                ),
                lhs: Reference(AstReferenceExpr(
                  span: Span(
                    low: 266,
                    high: 267,
                  ),
                  name: AstIdentifier(
                    name: "j",
                    span: Span(
                      low: 266,
                      high: 267,
                    ),
                  ),
                )),
                rhs: BinaryOp(AstBinaryOpExpr(
                  span: Span(
                    low: 270,
                    high: 275,
                  ),
                  lhs: Reference(AstReferenceExpr(
                    span: Span(
                      low: 270,
                      high: 271,
                    ),
                    name: AstIdentifier(
                      name: "j",
                      span: Span(
                        low: 270,
                        high: 271,
                      ),
                    ),
                  )),
                  rhs: IntegerLiteral(AstIntegerLiteralExpr(
                    span: Span(
                      low: 274,
                      high: 275,
                    ),
                    value: 1,
                  )),
                  op: Add,
                )),
              ))),
              body: [
                Let(AstLetStmt(
                  span: Span(
                    low: 285,
                    high: 297,
                  ),
                  name: AstIdentifier(
                    name: "sum",
                    span: Span(
                      low: 289,
                      high: 292,
                    ),
                  ),
                  type: None,
                  value: IntegerLiteral(AstIntegerLiteralExpr(
                    span: Span(
                      low: 295,
                      high: 296,
                    ),
                    value: 0,
                  )),
                )),
                For(AstForStmt(
                  span: Span(
                    low: 304,
                    high: 410,
                  ),
                  initializer: Some(AstForStmtInitializer(
                    span: Span(
                      low: 309,
                      high: 318,
                    ),
                    name: AstIdentifier(
                      name: "k",
                      span: Span(
                        low: 313,
                        high: 314,
                      ),
                    ),
                    initializer: IntegerLiteral(AstIntegerLiteralExpr(
                      span: Span(
                        low: 317,
                        high: 318,
                      ),
                      value: 0,
                    )),
                  )),
                  condition: Some(BinaryOp(AstBinaryOpExpr(
                    span: Span(
                      low: 320,
                      high: 327,
                    ),
                    lhs: Reference(AstReferenceExpr(
                      span: Span(
                        low: 320,
                        high: 321,
                      ),
                      name: AstIdentifier(
                        name: "k",
                        span: Span(
                          low: 320,
                          high: 321,
                        ),
                      ),
                    )),
                    rhs: DotIndex(AstDotIndexExpr(
                      span: Span(
                        low: 324,
                        high: 327,
                      ),
                      origin: Reference(AstReferenceExpr(
                        span: Span(
                          low: 324,
                          high: 325,
                        ),
                        name: AstIdentifier(
                          name: "a",
                          span: Span(
                            low: 324,
                            high: 325,
                          ),
                        ),
                      )),
                      index: AstIdentifier(
                        name: "c",
                        span: Span(
                          low: 326,
                          high: 327,
                        ),
                      ),
                    )),
                    op: Lt,
                  ))),
                  increment: Some(Assign(AstAssignExpr(
                    span: Span(
                      low: 329,
                      high: 338,
                    ),
                    lhs: Reference(AstReferenceExpr(
                      span: Span(
                        low: 329,
                        high: 330,
                      ),
                      name: AstIdentifier(
                        name: "k",
                        span: Span(
                          low: 329,
                          high: 330,
                        ),
                      ),
                    )),
                    rhs: BinaryOp(AstBinaryOpExpr(
                      span: Span(
                        low: 333,
                        high: 338,
                      ),
                      lhs: Reference(AstReferenceExpr(
                        span: Span(
                          low: 333,
                          high: 334,
                        ),
                        name: AstIdentifier(
                          name: "k",
                          span: Span(
                            low: 333,
                            high: 334,
                          ),
                        ),
                      )),
                      rhs: IntegerLiteral(AstIntegerLiteralExpr(
                        span: Span(
                          low: 337,
                          high: 338,
                        ),
                        value: 1,
                      )),
                      op: Add,
                    )),
                  ))),
                  body: [
                    Expr(AstExprStmt(
                      span: Span(
                        low: 350,
                        high: 402,
                      ),
                      expr: Assign(AstAssignExpr(
                        span: Span(
                          low: 350,
                          high: 401,
                        ),
                        lhs: Reference(AstReferenceExpr(
                          span: Span(
                            low: 350,
                            high: 353,
                          ),
                          name: AstIdentifier(
                            name: "sum",
                            span: Span(
                              low: 350,
                              high: 353,
                            ),
                          ),
                        )),
                        rhs: BinaryOp(AstBinaryOpExpr(
                          span: Span(
                            low: 356,
                            high: 401,
                          ),
                          lhs: Reference(AstReferenceExpr(
                            span: Span(
                              low: 356,
                              high: 359,
                            ),
                            name: AstIdentifier(
                              name: "sum",
                              span: Span(
                                low: 356,
                                high: 359,
                              ),
                            ),
                          )),
                          rhs: BinaryOp(AstBinaryOpExpr(
                            span: Span(
                              low: 362,
                              high: 401,
                            ),
                            lhs: BracketIndex(AstBracketIndexExpr(
                              span: Span(
                                low: 362,
                                high: 380,
                              ),
                              origin: DotIndex(AstDotIndexExpr(
                                span: Span(
                                  low: 362,
                                  high: 367,
                                ),
                                origin: Reference(AstReferenceExpr(
                                  span: Span(
                                    low: 362,
                                    high: 363,
                                  ),
                                  name: AstIdentifier(
                                    name: "a",
                                    span: Span(
                                      low: 362,
                                      high: 363,
                                    ),
                                  ),
                                )),
                                index: AstIdentifier(
                                  name: "buf",
                                  span: Span(
                                    low: 364,
                                    high: 367,
                                  ),
                                ),
                              )),
                              index: BinaryOp(AstBinaryOpExpr(
                                span: Span(
                                  low: 368,
                                  high: 379,
                                ),
                                lhs: BinaryOp(AstBinaryOpExpr(
                                  span: Span(
                                    low: 368,
                                    high: 375,
                                  ),
                                  lhs: Reference(AstReferenceExpr(
                                    span: Span(
                                      low: 368,
                                      high: 369,
                                    ),
                                    name: AstIdentifier(
                                      name: "i",
                                      span: Span(
                                        low: 368,
                                        high: 369,
                                      ),
                                    ),
                                  )),
                                  rhs: DotIndex(AstDotIndexExpr(
                                    span: Span(
                                      low: 372,
                                      high: 375,
                                    ),
                                    origin: Reference(AstReferenceExpr(
                                      span: Span(
                                        low: 372,
                                        high: 373,
                                      ),
                                      name: AstIdentifier(
                                        name: "a",
                                        span: Span(
                                          low: 372,
                                          high: 373,
                                        ),
                                      ),
                                    )),
                                    index: AstIdentifier(
                                      name: "c",
                                      span: Span(
                                        low: 374,
                                        high: 375,
                                      ),
                                    ),
                                  )),
                                  op: Mul,
                                )),
                                rhs: Reference(AstReferenceExpr(
                                  span: Span(
                                    low: 378,
                                    high: 379,
                                  ),
                                  name: AstIdentifier(
                                    name: "k",
                                    span: Span(
                                      low: 378,
                                      high: 379,
                                    ),
                                  ),
                                )),
                                op: Add,
                              )),
                            )),
                            rhs: BracketIndex(AstBracketIndexExpr(
                              span: Span(
                                low: 383,
                                high: 401,
                              ),
                              origin: DotIndex(AstDotIndexExpr(
                                span: Span(
                                  low: 383,
                                  high: 388,
                                ),
                                origin: Reference(AstReferenceExpr(
                                  span: Span(
                                    low: 383,
                                    high: 384,
                                  ),
                                  name: AstIdentifier(
                                    name: "b",
                                    span: Span(
                                      low: 383,
                                      high: 384,
                                    ),
                                  ),
                                )),
                                index: AstIdentifier(
                                  name: "buf",
                                  span: Span(
                                    low: 385,
                                    high: 388,
                                  ),
                                ),
                              )),
                              index: BinaryOp(AstBinaryOpExpr(
                                span: Span(
                                  low: 389,
                                  high: 400,
                                ),
                                lhs: BinaryOp(AstBinaryOpExpr(
                                  span: Span(
                                    low: 389,
                                    high: 396,
                                  ),
                                  lhs: Reference(AstReferenceExpr(
                                    span: Span(
                                      low: 389,
                                      high: 390,
                                    ),
                                    name: AstIdentifier(
                                      name: "k",
                                      span: Span(
                                        low: 389,
                                        high: 390,
                                      ),
                                    ),
                                  )),
                                  rhs: DotIndex(AstDotIndexExpr(
                                    span: Span(
                                      low: 393,
                                      high: 396,
                                    ),
                                    origin: Reference(AstReferenceExpr(
                                      span: Span(
                                        low: 393,
                                        high: 394,
                                      ),
                                      name: AstIdentifier(
                                        name: "b",
                                        span: Span(
                                          low: 393,
                                          high: 394,
                                        ),
                                      ),
                                    )),
                                    index: AstIdentifier(
                                      name: "c",
                                      span: Span(
                                        low: 395,
                                        high: 396,
                                      ),
                                    ),
                                  )),
                                  op: Mul,
                                )),
                                rhs: Reference(AstReferenceExpr(
                                  span: Span(
                                    low: 399,
                                    high: 400,
                                  ),
                                  name: AstIdentifier(
                                    name: "j",
                                    span: Span(
                                      low: 399,
                                      high: 400,
                                    ),
                                  ),
                                )),
                                op: Add,
                              )),
                            )),
                            op: Mul,
                          )),
                          op: Add,
                        )),
                      )),
                    )),
                  ],
                )),
                Expr(AstExprStmt(
                  span: Span(
                    low: 417,
                    high: 442,
                  ),
                  expr: Assign(AstAssignExpr(
                    span: Span(
                      low: 417,
                      high: 441,
                    ),
                    lhs: BracketIndex(AstBracketIndexExpr(
                      span: Span(
                        low: 417,
                        high: 435,
                      ),
                      origin: DotIndex(AstDotIndexExpr(
                        span: Span(
                          low: 417,
                          high: 422,
                        ),
                        origin: Reference(AstReferenceExpr(
                          span: Span(
                            low: 417,
                            high: 418,
                          ),
                          name: AstIdentifier(
                            name: "c",
                            span: Span(
                              low: 417,
                              high: 418,
                            ),
                          ),
                        )),
                        index: AstIdentifier(
                          name: "buf",
                          span: Span(
                            low: 419,
                            high: 422,
                          ),
                        ),
                      )),
                      index: BinaryOp(AstBinaryOpExpr(
                        span: Span(
                          low: 423,
                          high: 434,
                        ),
                        lhs: BinaryOp(AstBinaryOpExpr(
                          span: Span(
                            low: 423,
                            high: 430,
                          ),
                          lhs: Reference(AstReferenceExpr(
                            span: Span(
                              low: 423,
                              high: 424,
                            ),
                            name: AstIdentifier(
                              name: "i",
                              span: Span(
                                low: 423,
                                high: 424,
                              ),
                            ),
                          )),
                          rhs: DotIndex(AstDotIndexExpr(
                            span: Span(
                              low: 427,
                              high: 430,
                            ),
                            origin: Reference(AstReferenceExpr(
                              span: Span(
                                low: 427,
                                high: 428,
                              ),
                              name: AstIdentifier(
                                name: "b",
                                span: Span(
                                  low: 427,
                                  high: 428,
                                ),
                              ),
                            )),
                            index: AstIdentifier(
                              name: "c",
                              span: Span(
                                low: 429,
                                high: 430,
                              ),
                            ),
                          )),
                          op: Mul,
                        )),
                        rhs: Reference(AstReferenceExpr(
                          span: Span(
                            low: 433,
                            high: 434,
                          ),
                          name: AstIdentifier(
                            name: "j",
                            span: Span(
                              low: 433,
                              high: 434,
                            ),
                          ),
                        )),
                        op: Add,
                      )),
                    )),
                    rhs: Reference(AstReferenceExpr(
                      span: Span(
                        low: 438,
                        high: 441,
                      ),
                      name: AstIdentifier(
                        name: "sum",
                        span: Span(
                          low: 438,
                          high: 441,
                        ),
                      ),
                    )),
                  )),
                )),
              ],
            )),
          ],
        )),
        Return(AstReturnStmt(
          span: Span(
            low: 455,
            high: 464,
          ),
          value: Some(Reference(AstReferenceExpr(
            span: Span(
              low: 462,
              high: 463,
            ),
            name: AstIdentifier(
              name: "c",
              span: Span(
                low: 462,
                high: 463,
              ),
            ),
          ))),
        )),
      ],
    )),
  ],
)
