---
source: compiler/eight-syntax/tests/parser_tests.rs
expression: translation_unit
input_file: compiler/eight-syntax/tests/data/quicksort.test
snapshot_kind: text
---
AstTranslationUnit(
  items: [
    Function(AstFunctionItem(
      span: Span(
        low: 0,
        high: 152,
      ),
      name: AstIdentifier(
        name: "quicksort",
        span: Span(
          low: 3,
          high: 12,
        ),
      ),
      parameters: [
        AstFunctionParameterItem(
          span: Span(
            low: 13,
            high: 21,
          ),
          name: AstIdentifier(
            name: "xs",
            span: Span(
              low: 13,
              high: 15,
            ),
          ),
          type: Pointer(AstPointerType(
            span: Span(
              low: 17,
              high: 21,
            ),
            inner: Integer32(AstInteger32Type(
              span: Span(
                low: 18,
                high: 21,
              ),
            )),
          )),
        ),
        AstFunctionParameterItem(
          span: Span(
            low: 23,
            high: 29,
          ),
          name: AstIdentifier(
            name: "l",
            span: Span(
              low: 23,
              high: 24,
            ),
          ),
          type: Integer32(AstInteger32Type(
            span: Span(
              low: 26,
              high: 29,
            ),
          )),
        ),
        AstFunctionParameterItem(
          span: Span(
            low: 31,
            high: 37,
          ),
          name: AstIdentifier(
            name: "r",
            span: Span(
              low: 31,
              high: 32,
            ),
          ),
          type: Integer32(AstInteger32Type(
            span: Span(
              low: 34,
              high: 37,
            ),
          )),
        ),
      ],
      type_parameters: [],
      return_type: None,
      body: [
        If(AstIfStmt(
          span: Span(
            low: 43,
            high: 150,
          ),
          condition: BinaryOp(AstBinaryOpExpr(
            span: Span(
              low: 47,
              high: 52,
            ),
            lhs: Reference(AstReferenceExpr(
              span: Span(
                low: 47,
                high: 48,
              ),
              name: AstIdentifier(
                name: "l",
                span: Span(
                  low: 47,
                  high: 48,
                ),
              ),
            )),
            rhs: Reference(AstReferenceExpr(
              span: Span(
                low: 51,
                high: 52,
              ),
              name: AstIdentifier(
                name: "r",
                span: Span(
                  low: 51,
                  high: 52,
                ),
              ),
            )),
            op: Lt,
          )),
          happy_path: [
            Let(AstLetStmt(
              span: Span(
                low: 60,
                high: 88,
              ),
              name: AstIdentifier(
                name: "p",
                span: Span(
                  low: 64,
                  high: 65,
                ),
              ),
              type: None,
              value: Call(AstCallExpr(
                span: Span(
                  low: 68,
                  high: 87,
                ),
                callee: Reference(AstReferenceExpr(
                  span: Span(
                    low: 68,
                    high: 77,
                  ),
                  name: AstIdentifier(
                    name: "partition",
                    span: Span(
                      low: 68,
                      high: 77,
                    ),
                  ),
                )),
                arguments: [
                  Reference(AstReferenceExpr(
                    span: Span(
                      low: 78,
                      high: 80,
                    ),
                    name: AstIdentifier(
                      name: "xs",
                      span: Span(
                        low: 78,
                        high: 80,
                      ),
                    ),
                  )),
                  Reference(AstReferenceExpr(
                    span: Span(
                      low: 82,
                      high: 83,
                    ),
                    name: AstIdentifier(
                      name: "l",
                      span: Span(
                        low: 82,
                        high: 83,
                      ),
                    ),
                  )),
                  Reference(AstReferenceExpr(
                    span: Span(
                      low: 85,
                      high: 86,
                    ),
                    name: AstIdentifier(
                      name: "r",
                      span: Span(
                        low: 85,
                        high: 86,
                      ),
                    ),
                  )),
                ],
                type_arguments: [],
              )),
            )),
            Expr(AstExprStmt(
              span: Span(
                low: 93,
                high: 117,
              ),
              expr: Call(AstCallExpr(
                span: Span(
                  low: 93,
                  high: 116,
                ),
                callee: Reference(AstReferenceExpr(
                  span: Span(
                    low: 93,
                    high: 102,
                  ),
                  name: AstIdentifier(
                    name: "quicksort",
                    span: Span(
                      low: 93,
                      high: 102,
                    ),
                  ),
                )),
                arguments: [
                  Reference(AstReferenceExpr(
                    span: Span(
                      low: 103,
                      high: 105,
                    ),
                    name: AstIdentifier(
                      name: "xs",
                      span: Span(
                        low: 103,
                        high: 105,
                      ),
                    ),
                  )),
                  Reference(AstReferenceExpr(
                    span: Span(
                      low: 107,
                      high: 108,
                    ),
                    name: AstIdentifier(
                      name: "l",
                      span: Span(
                        low: 107,
                        high: 108,
                      ),
                    ),
                  )),
                  BinaryOp(AstBinaryOpExpr(
                    span: Span(
                      low: 110,
                      high: 115,
                    ),
                    lhs: Reference(AstReferenceExpr(
                      span: Span(
                        low: 110,
                        high: 111,
                      ),
                      name: AstIdentifier(
                        name: "p",
                        span: Span(
                          low: 110,
                          high: 111,
                        ),
                      ),
                    )),
                    rhs: IntegerLiteral(AstIntegerLiteralExpr(
                      span: Span(
                        low: 114,
                        high: 115,
                      ),
                      value: 1,
                    )),
                    op: Sub,
                  )),
                ],
                type_arguments: [],
              )),
            )),
            Expr(AstExprStmt(
              span: Span(
                low: 122,
                high: 146,
              ),
              expr: Call(AstCallExpr(
                span: Span(
                  low: 122,
                  high: 145,
                ),
                callee: Reference(AstReferenceExpr(
                  span: Span(
                    low: 122,
                    high: 131,
                  ),
                  name: AstIdentifier(
                    name: "quicksort",
                    span: Span(
                      low: 122,
                      high: 131,
                    ),
                  ),
                )),
                arguments: [
                  Reference(AstReferenceExpr(
                    span: Span(
                      low: 132,
                      high: 134,
                    ),
                    name: AstIdentifier(
                      name: "xs",
                      span: Span(
                        low: 132,
                        high: 134,
                      ),
                    ),
                  )),
                  BinaryOp(AstBinaryOpExpr(
                    span: Span(
                      low: 136,
                      high: 141,
                    ),
                    lhs: Reference(AstReferenceExpr(
                      span: Span(
                        low: 136,
                        high: 137,
                      ),
                      name: AstIdentifier(
                        name: "p",
                        span: Span(
                          low: 136,
                          high: 137,
                        ),
                      ),
                    )),
                    rhs: IntegerLiteral(AstIntegerLiteralExpr(
                      span: Span(
                        low: 140,
                        high: 141,
                      ),
                      value: 1,
                    )),
                    op: Add,
                  )),
                  Reference(AstReferenceExpr(
                    span: Span(
                      low: 143,
                      high: 144,
                    ),
                    name: AstIdentifier(
                      name: "r",
                      span: Span(
                        low: 143,
                        high: 144,
                      ),
                    ),
                  )),
                ],
                type_arguments: [],
              )),
            )),
          ],
          unhappy_path: None,
        )),
      ],
    )),
    Function(AstFunctionItem(
      span: Span(
        low: 154,
        high: 396,
      ),
      name: AstIdentifier(
        name: "partition",
        span: Span(
          low: 157,
          high: 166,
        ),
      ),
      parameters: [
        AstFunctionParameterItem(
          span: Span(
            low: 167,
            high: 175,
          ),
          name: AstIdentifier(
            name: "xs",
            span: Span(
              low: 167,
              high: 169,
            ),
          ),
          type: Pointer(AstPointerType(
            span: Span(
              low: 171,
              high: 175,
            ),
            inner: Integer32(AstInteger32Type(
              span: Span(
                low: 172,
                high: 175,
              ),
            )),
          )),
        ),
        AstFunctionParameterItem(
          span: Span(
            low: 177,
            high: 183,
          ),
          name: AstIdentifier(
            name: "l",
            span: Span(
              low: 177,
              high: 178,
            ),
          ),
          type: Integer32(AstInteger32Type(
            span: Span(
              low: 180,
              high: 183,
            ),
          )),
        ),
        AstFunctionParameterItem(
          span: Span(
            low: 185,
            high: 191,
          ),
          name: AstIdentifier(
            name: "r",
            span: Span(
              low: 185,
              high: 186,
            ),
          ),
          type: Integer32(AstInteger32Type(
            span: Span(
              low: 188,
              high: 191,
            ),
          )),
        ),
      ],
      type_parameters: [],
      return_type: Some(Integer32(AstInteger32Type(
        span: Span(
          low: 196,
          high: 199,
        ),
      ))),
      body: [
        Let(AstLetStmt(
          span: Span(
            low: 204,
            high: 218,
          ),
          name: AstIdentifier(
            name: "x",
            span: Span(
              low: 208,
              high: 209,
            ),
          ),
          type: None,
          value: BracketIndex(AstBracketIndexExpr(
            span: Span(
              low: 212,
              high: 217,
            ),
            origin: Reference(AstReferenceExpr(
              span: Span(
                low: 212,
                high: 214,
              ),
              name: AstIdentifier(
                name: "xs",
                span: Span(
                  low: 212,
                  high: 214,
                ),
              ),
            )),
            index: Reference(AstReferenceExpr(
              span: Span(
                low: 215,
                high: 216,
              ),
              name: AstIdentifier(
                name: "r",
                span: Span(
                  low: 215,
                  high: 216,
                ),
              ),
            )),
          )),
        )),
        Let(AstLetStmt(
          span: Span(
            low: 221,
            high: 235,
          ),
          name: AstIdentifier(
            name: "i",
            span: Span(
              low: 225,
              high: 226,
            ),
          ),
          type: None,
          value: BinaryOp(AstBinaryOpExpr(
            span: Span(
              low: 229,
              high: 234,
            ),
            lhs: Reference(AstReferenceExpr(
              span: Span(
                low: 229,
                high: 230,
              ),
              name: AstIdentifier(
                name: "l",
                span: Span(
                  low: 229,
                  high: 230,
                ),
              ),
            )),
            rhs: IntegerLiteral(AstIntegerLiteralExpr(
              span: Span(
                low: 233,
                high: 234,
              ),
              value: 1,
            )),
            op: Sub,
          )),
        )),
        For(AstForStmt(
          span: Span(
            low: 238,
            high: 350,
          ),
          initializer: Some(AstForStmtInitializer(
            span: Span(
              low: 243,
              high: 252,
            ),
            name: AstIdentifier(
              name: "j",
              span: Span(
                low: 247,
                high: 248,
              ),
            ),
            initializer: Reference(AstReferenceExpr(
              span: Span(
                low: 251,
                high: 252,
              ),
              name: AstIdentifier(
                name: "l",
                span: Span(
                  low: 251,
                  high: 252,
                ),
              ),
            )),
          )),
          condition: Some(BinaryOp(AstBinaryOpExpr(
            span: Span(
              low: 254,
              high: 259,
            ),
            lhs: Reference(AstReferenceExpr(
              span: Span(
                low: 254,
                high: 255,
              ),
              name: AstIdentifier(
                name: "j",
                span: Span(
                  low: 254,
                  high: 255,
                ),
              ),
            )),
            rhs: Reference(AstReferenceExpr(
              span: Span(
                low: 258,
                high: 259,
              ),
              name: AstIdentifier(
                name: "r",
                span: Span(
                  low: 258,
                  high: 259,
                ),
              ),
            )),
            op: Lt,
          ))),
          increment: Some(Assign(AstAssignExpr(
            span: Span(
              low: 261,
              high: 270,
            ),
            lhs: Reference(AstReferenceExpr(
              span: Span(
                low: 261,
                high: 262,
              ),
              name: AstIdentifier(
                name: "j",
                span: Span(
                  low: 261,
                  high: 262,
                ),
              ),
            )),
            rhs: BinaryOp(AstBinaryOpExpr(
              span: Span(
                low: 265,
                high: 270,
              ),
              lhs: Reference(AstReferenceExpr(
                span: Span(
                  low: 265,
                  high: 266,
                ),
                name: AstIdentifier(
                  name: "j",
                  span: Span(
                    low: 265,
                    high: 266,
                  ),
                ),
              )),
              rhs: IntegerLiteral(AstIntegerLiteralExpr(
                span: Span(
                  low: 269,
                  high: 270,
                ),
                value: 1,
              )),
              op: Add,
            )),
          ))),
          body: [
            If(AstIfStmt(
              span: Span(
                low: 278,
                high: 346,
              ),
              condition: BinaryOp(AstBinaryOpExpr(
                span: Span(
                  low: 282,
                  high: 292,
                ),
                lhs: BracketIndex(AstBracketIndexExpr(
                  span: Span(
                    low: 282,
                    high: 287,
                  ),
                  origin: Reference(AstReferenceExpr(
                    span: Span(
                      low: 282,
                      high: 284,
                    ),
                    name: AstIdentifier(
                      name: "xs",
                      span: Span(
                        low: 282,
                        high: 284,
                      ),
                    ),
                  )),
                  index: Reference(AstReferenceExpr(
                    span: Span(
                      low: 285,
                      high: 286,
                    ),
                    name: AstIdentifier(
                      name: "j",
                      span: Span(
                        low: 285,
                        high: 286,
                      ),
                    ),
                  )),
                )),
                rhs: Reference(AstReferenceExpr(
                  span: Span(
                    low: 291,
                    high: 292,
                  ),
                  name: AstIdentifier(
                    name: "x",
                    span: Span(
                      low: 291,
                      high: 292,
                    ),
                  ),
                )),
                op: Lte,
              )),
              happy_path: [
                Expr(AstExprStmt(
                  span: Span(
                    low: 302,
                    high: 312,
                  ),
                  expr: Assign(AstAssignExpr(
                    span: Span(
                      low: 302,
                      high: 311,
                    ),
                    lhs: Reference(AstReferenceExpr(
                      span: Span(
                        low: 302,
                        high: 303,
                      ),
                      name: AstIdentifier(
                        name: "i",
                        span: Span(
                          low: 302,
                          high: 303,
                        ),
                      ),
                    )),
                    rhs: BinaryOp(AstBinaryOpExpr(
                      span: Span(
                        low: 306,
                        high: 311,
                      ),
                      lhs: Reference(AstReferenceExpr(
                        span: Span(
                          low: 306,
                          high: 307,
                        ),
                        name: AstIdentifier(
                          name: "i",
                          span: Span(
                            low: 306,
                            high: 307,
                          ),
                        ),
                      )),
                      rhs: IntegerLiteral(AstIntegerLiteralExpr(
                        span: Span(
                          low: 310,
                          high: 311,
                        ),
                        value: 1,
                      )),
                      op: Add,
                    )),
                  )),
                )),
                Expr(AstExprStmt(
                  span: Span(
                    low: 319,
                    high: 340,
                  ),
                  expr: Call(AstCallExpr(
                    span: Span(
                      low: 319,
                      high: 339,
                    ),
                    callee: Reference(AstReferenceExpr(
                      span: Span(
                        low: 319,
                        high: 323,
                      ),
                      name: AstIdentifier(
                        name: "swap",
                        span: Span(
                          low: 319,
                          high: 323,
                        ),
                      ),
                    )),
                    arguments: [
                      UnaryOp(AstUnaryOpExpr(
                        span: Span(
                          low: 324,
                          high: 330,
                        ),
                        operand: BracketIndex(AstBracketIndexExpr(
                          span: Span(
                            low: 325,
                            high: 330,
                          ),
                          origin: Reference(AstReferenceExpr(
                            span: Span(
                              low: 325,
                              high: 327,
                            ),
                            name: AstIdentifier(
                              name: "xs",
                              span: Span(
                                low: 325,
                                high: 327,
                              ),
                            ),
                          )),
                          index: Reference(AstReferenceExpr(
                            span: Span(
                              low: 328,
                              high: 329,
                            ),
                            name: AstIdentifier(
                              name: "i",
                              span: Span(
                                low: 328,
                                high: 329,
                              ),
                            ),
                          )),
                        )),
                        op: AddressOf,
                      )),
                      UnaryOp(AstUnaryOpExpr(
                        span: Span(
                          low: 332,
                          high: 338,
                        ),
                        operand: BracketIndex(AstBracketIndexExpr(
                          span: Span(
                            low: 333,
                            high: 338,
                          ),
                          origin: Reference(AstReferenceExpr(
                            span: Span(
                              low: 333,
                              high: 335,
                            ),
                            name: AstIdentifier(
                              name: "xs",
                              span: Span(
                                low: 333,
                                high: 335,
                              ),
                            ),
                          )),
                          index: Reference(AstReferenceExpr(
                            span: Span(
                              low: 336,
                              high: 337,
                            ),
                            name: AstIdentifier(
                              name: "j",
                              span: Span(
                                low: 336,
                                high: 337,
                              ),
                            ),
                          )),
                        )),
                        op: AddressOf,
                      )),
                    ],
                    type_arguments: [],
                  )),
                )),
              ],
              unhappy_path: None,
            )),
          ],
        )),
        Expr(AstExprStmt(
          span: Span(
            low: 353,
            high: 378,
          ),
          expr: Call(AstCallExpr(
            span: Span(
              low: 353,
              high: 377,
            ),
            callee: Reference(AstReferenceExpr(
              span: Span(
                low: 353,
                high: 357,
              ),
              name: AstIdentifier(
                name: "swap",
                span: Span(
                  low: 353,
                  high: 357,
                ),
              ),
            )),
            arguments: [
              UnaryOp(AstUnaryOpExpr(
                span: Span(
                  low: 358,
                  high: 368,
                ),
                operand: BracketIndex(AstBracketIndexExpr(
                  span: Span(
                    low: 359,
                    high: 368,
                  ),
                  origin: Reference(AstReferenceExpr(
                    span: Span(
                      low: 359,
                      high: 361,
                    ),
                    name: AstIdentifier(
                      name: "xs",
                      span: Span(
                        low: 359,
                        high: 361,
                      ),
                    ),
                  )),
                  index: BinaryOp(AstBinaryOpExpr(
                    span: Span(
                      low: 362,
                      high: 367,
                    ),
                    lhs: Reference(AstReferenceExpr(
                      span: Span(
                        low: 362,
                        high: 363,
                      ),
                      name: AstIdentifier(
                        name: "i",
                        span: Span(
                          low: 362,
                          high: 363,
                        ),
                      ),
                    )),
                    rhs: IntegerLiteral(AstIntegerLiteralExpr(
                      span: Span(
                        low: 366,
                        high: 367,
                      ),
                      value: 1,
                    )),
                    op: Add,
                  )),
                )),
                op: AddressOf,
              )),
              UnaryOp(AstUnaryOpExpr(
                span: Span(
                  low: 370,
                  high: 376,
                ),
                operand: BracketIndex(AstBracketIndexExpr(
                  span: Span(
                    low: 371,
                    high: 376,
                  ),
                  origin: Reference(AstReferenceExpr(
                    span: Span(
                      low: 371,
                      high: 373,
                    ),
                    name: AstIdentifier(
                      name: "xs",
                      span: Span(
                        low: 371,
                        high: 373,
                      ),
                    ),
                  )),
                  index: Reference(AstReferenceExpr(
                    span: Span(
                      low: 374,
                      high: 375,
                    ),
                    name: AstIdentifier(
                      name: "r",
                      span: Span(
                        low: 374,
                        high: 375,
                      ),
                    ),
                  )),
                )),
                op: AddressOf,
              )),
            ],
            type_arguments: [],
          )),
        )),
        Return(AstReturnStmt(
          span: Span(
            low: 381,
            high: 394,
          ),
          value: Some(BinaryOp(AstBinaryOpExpr(
            span: Span(
              low: 388,
              high: 393,
            ),
            lhs: Reference(AstReferenceExpr(
              span: Span(
                low: 388,
                high: 389,
              ),
              name: AstIdentifier(
                name: "i",
                span: Span(
                  low: 388,
                  high: 389,
                ),
              ),
            )),
            rhs: IntegerLiteral(AstIntegerLiteralExpr(
              span: Span(
                low: 392,
                high: 393,
              ),
              value: 1,
            )),
            op: Add,
          ))),
        )),
      ],
    )),
    Function(AstFunctionItem(
      span: Span(
        low: 398,
        high: 466,
      ),
      name: AstIdentifier(
        name: "swap",
        span: Span(
          low: 401,
          high: 405,
        ),
      ),
      parameters: [
        AstFunctionParameterItem(
          span: Span(
            low: 406,
            high: 413,
          ),
          name: AstIdentifier(
            name: "a",
            span: Span(
              low: 406,
              high: 407,
            ),
          ),
          type: Pointer(AstPointerType(
            span: Span(
              low: 409,
              high: 413,
            ),
            inner: Integer32(AstInteger32Type(
              span: Span(
                low: 410,
                high: 413,
              ),
            )),
          )),
        ),
        AstFunctionParameterItem(
          span: Span(
            low: 415,
            high: 422,
          ),
          name: AstIdentifier(
            name: "b",
            span: Span(
              low: 415,
              high: 416,
            ),
          ),
          type: Pointer(AstPointerType(
            span: Span(
              low: 418,
              high: 422,
            ),
            inner: Integer32(AstInteger32Type(
              span: Span(
                low: 419,
                high: 422,
              ),
            )),
          )),
        ),
      ],
      type_parameters: [],
      return_type: None,
      body: [
        Let(AstLetStmt(
          span: Span(
            low: 428,
            high: 441,
          ),
          name: AstIdentifier(
            name: "tmp",
            span: Span(
              low: 432,
              high: 435,
            ),
          ),
          type: None,
          value: UnaryOp(AstUnaryOpExpr(
            span: Span(
              low: 438,
              high: 440,
            ),
            operand: Reference(AstReferenceExpr(
              span: Span(
                low: 439,
                high: 440,
              ),
              name: AstIdentifier(
                name: "a",
                span: Span(
                  low: 439,
                  high: 440,
                ),
              ),
            )),
            op: Deref,
          )),
        )),
        Expr(AstExprStmt(
          span: Span(
            low: 444,
            high: 452,
          ),
          expr: Assign(AstAssignExpr(
            span: Span(
              low: 444,
              high: 451,
            ),
            lhs: UnaryOp(AstUnaryOpExpr(
              span: Span(
                low: 444,
                high: 446,
              ),
              operand: Reference(AstReferenceExpr(
                span: Span(
                  low: 445,
                  high: 446,
                ),
                name: AstIdentifier(
                  name: "a",
                  span: Span(
                    low: 445,
                    high: 446,
                  ),
                ),
              )),
              op: Deref,
            )),
            rhs: UnaryOp(AstUnaryOpExpr(
              span: Span(
                low: 449,
                high: 451,
              ),
              operand: Reference(AstReferenceExpr(
                span: Span(
                  low: 450,
                  high: 451,
                ),
                name: AstIdentifier(
                  name: "b",
                  span: Span(
                    low: 450,
                    high: 451,
                  ),
                ),
              )),
              op: Deref,
            )),
          )),
        )),
        Expr(AstExprStmt(
          span: Span(
            low: 455,
            high: 464,
          ),
          expr: Assign(AstAssignExpr(
            span: Span(
              low: 455,
              high: 463,
            ),
            lhs: UnaryOp(AstUnaryOpExpr(
              span: Span(
                low: 455,
                high: 457,
              ),
              operand: Reference(AstReferenceExpr(
                span: Span(
                  low: 456,
                  high: 457,
                ),
                name: AstIdentifier(
                  name: "b",
                  span: Span(
                    low: 456,
                    high: 457,
                  ),
                ),
              )),
              op: Deref,
            )),
            rhs: Reference(AstReferenceExpr(
              span: Span(
                low: 460,
                high: 463,
              ),
              name: AstIdentifier(
                name: "tmp",
                span: Span(
                  low: 460,
                  high: 463,
                ),
              ),
            )),
          )),
        )),
      ],
    )),
  ],
)
