---
source: compiler/eight-tests/tests/compiler_tests.rs
description: compiler test suite for syntax
info:
  program: eightc
  args:
    - "--emit-ast"
    - tests/syntax/quicksort.test
input_file: compiler/eight-tests/tests/syntax/quicksort.test
snapshot_kind: text
---
success: false
exit_code: 1
----- stdout -----
(
    items: [
        Function((
            span: (
                low: 0,
                high: 152,
            ),
            name: (
                name: "quicksort",
                span: (
                    low: 3,
                    high: 12,
                ),
            ),
            parameters: [
                (
                    span: (
                        low: 13,
                        high: 21,
                    ),
                    name: (
                        name: "xs",
                        span: (
                            low: 13,
                            high: 15,
                        ),
                    ),
                    ty: Pointer((
                        span: (
                            low: 17,
                            high: 21,
                        ),
                        inner: Integer32((
                            span: (
                                low: 18,
                                high: 21,
                            ),
                        )),
                    )),
                ),
                (
                    span: (
                        low: 23,
                        high: 29,
                    ),
                    name: (
                        name: "l",
                        span: (
                            low: 23,
                            high: 24,
                        ),
                    ),
                    ty: Integer32((
                        span: (
                            low: 26,
                            high: 29,
                        ),
                    )),
                ),
                (
                    span: (
                        low: 31,
                        high: 37,
                    ),
                    name: (
                        name: "r",
                        span: (
                            low: 31,
                            high: 32,
                        ),
                    ),
                    ty: Integer32((
                        span: (
                            low: 34,
                            high: 37,
                        ),
                    )),
                ),
            ],
            type_parameters: [],
            return_type: None,
            body: [
                If((
                    span: (
                        low: 43,
                        high: 150,
                    ),
                    condition: BinaryOp((
                        span: (
                            low: 47,
                            high: 52,
                        ),
                        lhs: Reference((
                            span: (
                                low: 47,
                                high: 48,
                            ),
                            name: (
                                name: "l",
                                span: (
                                    low: 47,
                                    high: 48,
                                ),
                            ),
                        )),
                        rhs: Reference((
                            span: (
                                low: 51,
                                high: 52,
                            ),
                            name: (
                                name: "r",
                                span: (
                                    low: 51,
                                    high: 52,
                                ),
                            ),
                        )),
                        op: Lt,
                        op_span: (
                            low: 49,
                            high: 50,
                        ),
                    )),
                    happy_path: [
                        Let((
                            span: (
                                low: 60,
                                high: 88,
                            ),
                            name: (
                                name: "p",
                                span: (
                                    low: 64,
                                    high: 65,
                                ),
                            ),
                            ty: None,
                            value: Call((
                                span: (
                                    low: 68,
                                    high: 87,
                                ),
                                callee: Reference((
                                    span: (
                                        low: 68,
                                        high: 77,
                                    ),
                                    name: (
                                        name: "partition",
                                        span: (
                                            low: 68,
                                            high: 77,
                                        ),
                                    ),
                                )),
                                arguments: [
                                    Reference((
                                        span: (
                                            low: 78,
                                            high: 80,
                                        ),
                                        name: (
                                            name: "xs",
                                            span: (
                                                low: 78,
                                                high: 80,
                                            ),
                                        ),
                                    )),
                                    Reference((
                                        span: (
                                            low: 82,
                                            high: 83,
                                        ),
                                        name: (
                                            name: "l",
                                            span: (
                                                low: 82,
                                                high: 83,
                                            ),
                                        ),
                                    )),
                                    Reference((
                                        span: (
                                            low: 85,
                                            high: 86,
                                        ),
                                        name: (
                                            name: "r",
                                            span: (
                                                low: 85,
                                                high: 86,
                                            ),
                                        ),
                                    )),
                                ],
                                type_arguments: [],
                            )),
                        )),
                        Expr((
                            span: (
                                low: 93,
                                high: 117,
                            ),
                            expr: Call((
                                span: (
                                    low: 93,
                                    high: 116,
                                ),
                                callee: Reference((
                                    span: (
                                        low: 93,
                                        high: 102,
                                    ),
                                    name: (
                                        name: "quicksort",
                                        span: (
                                            low: 93,
                                            high: 102,
                                        ),
                                    ),
                                )),
                                arguments: [
                                    Reference((
                                        span: (
                                            low: 103,
                                            high: 105,
                                        ),
                                        name: (
                                            name: "xs",
                                            span: (
                                                low: 103,
                                                high: 105,
                                            ),
                                        ),
                                    )),
                                    Reference((
                                        span: (
                                            low: 107,
                                            high: 108,
                                        ),
                                        name: (
                                            name: "l",
                                            span: (
                                                low: 107,
                                                high: 108,
                                            ),
                                        ),
                                    )),
                                    BinaryOp((
                                        span: (
                                            low: 110,
                                            high: 115,
                                        ),
                                        lhs: Reference((
                                            span: (
                                                low: 110,
                                                high: 111,
                                            ),
                                            name: (
                                                name: "p",
                                                span: (
                                                    low: 110,
                                                    high: 111,
                                                ),
                                            ),
                                        )),
                                        rhs: IntegerLiteral((
                                            span: (
                                                low: 114,
                                                high: 115,
                                            ),
                                            value: 1,
                                        )),
                                        op: Sub,
                                        op_span: (
                                            low: 112,
                                            high: 113,
                                        ),
                                    )),
                                ],
                                type_arguments: [],
                            )),
                        )),
                        Expr((
                            span: (
                                low: 122,
                                high: 146,
                            ),
                            expr: Call((
                                span: (
                                    low: 122,
                                    high: 145,
                                ),
                                callee: Reference((
                                    span: (
                                        low: 122,
                                        high: 131,
                                    ),
                                    name: (
                                        name: "quicksort",
                                        span: (
                                            low: 122,
                                            high: 131,
                                        ),
                                    ),
                                )),
                                arguments: [
                                    Reference((
                                        span: (
                                            low: 132,
                                            high: 134,
                                        ),
                                        name: (
                                            name: "xs",
                                            span: (
                                                low: 132,
                                                high: 134,
                                            ),
                                        ),
                                    )),
                                    BinaryOp((
                                        span: (
                                            low: 136,
                                            high: 141,
                                        ),
                                        lhs: Reference((
                                            span: (
                                                low: 136,
                                                high: 137,
                                            ),
                                            name: (
                                                name: "p",
                                                span: (
                                                    low: 136,
                                                    high: 137,
                                                ),
                                            ),
                                        )),
                                        rhs: IntegerLiteral((
                                            span: (
                                                low: 140,
                                                high: 141,
                                            ),
                                            value: 1,
                                        )),
                                        op: Add,
                                        op_span: (
                                            low: 138,
                                            high: 139,
                                        ),
                                    )),
                                    Reference((
                                        span: (
                                            low: 143,
                                            high: 144,
                                        ),
                                        name: (
                                            name: "r",
                                            span: (
                                                low: 143,
                                                high: 144,
                                            ),
                                        ),
                                    )),
                                ],
                                type_arguments: [],
                            )),
                        )),
                    ],
                    unhappy_path: None,
                )),
            ],
        )),
        Function((
            span: (
                low: 154,
                high: 396,
            ),
            name: (
                name: "partition",
                span: (
                    low: 157,
                    high: 166,
                ),
            ),
            parameters: [
                (
                    span: (
                        low: 167,
                        high: 175,
                    ),
                    name: (
                        name: "xs",
                        span: (
                            low: 167,
                            high: 169,
                        ),
                    ),
                    ty: Pointer((
                        span: (
                            low: 171,
                            high: 175,
                        ),
                        inner: Integer32((
                            span: (
                                low: 172,
                                high: 175,
                            ),
                        )),
                    )),
                ),
                (
                    span: (
                        low: 177,
                        high: 183,
                    ),
                    name: (
                        name: "l",
                        span: (
                            low: 177,
                            high: 178,
                        ),
                    ),
                    ty: Integer32((
                        span: (
                            low: 180,
                            high: 183,
                        ),
                    )),
                ),
                (
                    span: (
                        low: 185,
                        high: 191,
                    ),
                    name: (
                        name: "r",
                        span: (
                            low: 185,
                            high: 186,
                        ),
                    ),
                    ty: Integer32((
                        span: (
                            low: 188,
                            high: 191,
                        ),
                    )),
                ),
            ],
            type_parameters: [],
            return_type: Some(Integer32((
                span: (
                    low: 196,
                    high: 199,
                ),
            ))),
            body: [
                Let((
                    span: (
                        low: 204,
                        high: 218,
                    ),
                    name: (
                        name: "x",
                        span: (
                            low: 208,
                            high: 209,
                        ),
                    ),
                    ty: None,
                    value: BracketIndex((
                        span: (
                            low: 212,
                            high: 217,
                        ),
                        origin: Reference((
                            span: (
                                low: 212,
                                high: 214,
                            ),
                            name: (
                                name: "xs",
                                span: (
                                    low: 212,
                                    high: 214,
                                ),
                            ),
                        )),
                        index: Reference((
                            span: (
                                low: 215,
                                high: 216,
                            ),
                            name: (
                                name: "r",
                                span: (
                                    low: 215,
                                    high: 216,
                                ),
                            ),
                        )),
                    )),
                )),
                Let((
                    span: (
                        low: 221,
                        high: 235,
                    ),
                    name: (
                        name: "i",
                        span: (
                            low: 225,
                            high: 226,
                        ),
                    ),
                    ty: None,
                    value: BinaryOp((
                        span: (
                            low: 229,
                            high: 234,
                        ),
                        lhs: Reference((
                            span: (
                                low: 229,
                                high: 230,
                            ),
                            name: (
                                name: "l",
                                span: (
                                    low: 229,
                                    high: 230,
                                ),
                            ),
                        )),
                        rhs: IntegerLiteral((
                            span: (
                                low: 233,
                                high: 234,
                            ),
                            value: 1,
                        )),
                        op: Sub,
                        op_span: (
                            low: 231,
                            high: 232,
                        ),
                    )),
                )),
                For((
                    span: (
                        low: 238,
                        high: 350,
                    ),
                    initializer: Some((
                        span: (
                            low: 243,
                            high: 252,
                        ),
                        name: (
                            name: "j",
                            span: (
                                low: 247,
                                high: 248,
                            ),
                        ),
                        initializer: Reference((
                            span: (
                                low: 251,
                                high: 252,
                            ),
                            name: (
                                name: "l",
                                span: (
                                    low: 251,
                                    high: 252,
                                ),
                            ),
                        )),
                    )),
                    condition: Some(BinaryOp((
                        span: (
                            low: 254,
                            high: 259,
                        ),
                        lhs: Reference((
                            span: (
                                low: 254,
                                high: 255,
                            ),
                            name: (
                                name: "j",
                                span: (
                                    low: 254,
                                    high: 255,
                                ),
                            ),
                        )),
                        rhs: Reference((
                            span: (
                                low: 258,
                                high: 259,
                            ),
                            name: (
                                name: "r",
                                span: (
                                    low: 258,
                                    high: 259,
                                ),
                            ),
                        )),
                        op: Lt,
                        op_span: (
                            low: 256,
                            high: 257,
                        ),
                    ))),
                    increment: Some(Assign((
                        span: (
                            low: 261,
                            high: 270,
                        ),
                        lhs: Reference((
                            span: (
                                low: 261,
                                high: 262,
                            ),
                            name: (
                                name: "j",
                                span: (
                                    low: 261,
                                    high: 262,
                                ),
                            ),
                        )),
                        rhs: BinaryOp((
                            span: (
                                low: 265,
                                high: 270,
                            ),
                            lhs: Reference((
                                span: (
                                    low: 265,
                                    high: 266,
                                ),
                                name: (
                                    name: "j",
                                    span: (
                                        low: 265,
                                        high: 266,
                                    ),
                                ),
                            )),
                            rhs: IntegerLiteral((
                                span: (
                                    low: 269,
                                    high: 270,
                                ),
                                value: 1,
                            )),
                            op: Add,
                            op_span: (
                                low: 267,
                                high: 268,
                            ),
                        )),
                    ))),
                    body: [
                        If((
                            span: (
                                low: 278,
                                high: 346,
                            ),
                            condition: BinaryOp((
                                span: (
                                    low: 282,
                                    high: 292,
                                ),
                                lhs: BracketIndex((
                                    span: (
                                        low: 282,
                                        high: 287,
                                    ),
                                    origin: Reference((
                                        span: (
                                            low: 282,
                                            high: 284,
                                        ),
                                        name: (
                                            name: "xs",
                                            span: (
                                                low: 282,
                                                high: 284,
                                            ),
                                        ),
                                    )),
                                    index: Reference((
                                        span: (
                                            low: 285,
                                            high: 286,
                                        ),
                                        name: (
                                            name: "j",
                                            span: (
                                                low: 285,
                                                high: 286,
                                            ),
                                        ),
                                    )),
                                )),
                                rhs: Reference((
                                    span: (
                                        low: 291,
                                        high: 292,
                                    ),
                                    name: (
                                        name: "x",
                                        span: (
                                            low: 291,
                                            high: 292,
                                        ),
                                    ),
                                )),
                                op: Lte,
                                op_span: (
                                    low: 288,
                                    high: 290,
                                ),
                            )),
                            happy_path: [
                                Expr((
                                    span: (
                                        low: 302,
                                        high: 312,
                                    ),
                                    expr: Assign((
                                        span: (
                                            low: 302,
                                            high: 311,
                                        ),
                                        lhs: Reference((
                                            span: (
                                                low: 302,
                                                high: 303,
                                            ),
                                            name: (
                                                name: "i",
                                                span: (
                                                    low: 302,
                                                    high: 303,
                                                ),
                                            ),
                                        )),
                                        rhs: BinaryOp((
                                            span: (
                                                low: 306,
                                                high: 311,
                                            ),
                                            lhs: Reference((
                                                span: (
                                                    low: 306,
                                                    high: 307,
                                                ),
                                                name: (
                                                    name: "i",
                                                    span: (
                                                        low: 306,
                                                        high: 307,
                                                    ),
                                                ),
                                            )),
                                            rhs: IntegerLiteral((
                                                span: (
                                                    low: 310,
                                                    high: 311,
                                                ),
                                                value: 1,
                                            )),
                                            op: Add,
                                            op_span: (
                                                low: 308,
                                                high: 309,
                                            ),
                                        )),
                                    )),
                                )),
                                Expr((
                                    span: (
                                        low: 319,
                                        high: 340,
                                    ),
                                    expr: Call((
                                        span: (
                                            low: 319,
                                            high: 339,
                                        ),
                                        callee: Reference((
                                            span: (
                                                low: 319,
                                                high: 323,
                                            ),
                                            name: (
                                                name: "swap",
                                                span: (
                                                    low: 319,
                                                    high: 323,
                                                ),
                                            ),
                                        )),
                                        arguments: [
                                            UnaryOp((
                                                span: (
                                                    low: 324,
                                                    high: 330,
                                                ),
                                                operand: BracketIndex((
                                                    span: (
                                                        low: 325,
                                                        high: 330,
                                                    ),
                                                    origin: Reference((
                                                        span: (
                                                            low: 325,
                                                            high: 327,
                                                        ),
                                                        name: (
                                                            name: "xs",
                                                            span: (
                                                                low: 325,
                                                                high: 327,
                                                            ),
                                                        ),
                                                    )),
                                                    index: Reference((
                                                        span: (
                                                            low: 328,
                                                            high: 329,
                                                        ),
                                                        name: (
                                                            name: "i",
                                                            span: (
                                                                low: 328,
                                                                high: 329,
                                                            ),
                                                        ),
                                                    )),
                                                )),
                                                op: AddressOf,
                                                op_span: (
                                                    low: 324,
                                                    high: 325,
                                                ),
                                            )),
                                            UnaryOp((
                                                span: (
                                                    low: 332,
                                                    high: 338,
                                                ),
                                                operand: BracketIndex((
                                                    span: (
                                                        low: 333,
                                                        high: 338,
                                                    ),
                                                    origin: Reference((
                                                        span: (
                                                            low: 333,
                                                            high: 335,
                                                        ),
                                                        name: (
                                                            name: "xs",
                                                            span: (
                                                                low: 333,
                                                                high: 335,
                                                            ),
                                                        ),
                                                    )),
                                                    index: Reference((
                                                        span: (
                                                            low: 336,
                                                            high: 337,
                                                        ),
                                                        name: (
                                                            name: "j",
                                                            span: (
                                                                low: 336,
                                                                high: 337,
                                                            ),
                                                        ),
                                                    )),
                                                )),
                                                op: AddressOf,
                                                op_span: (
                                                    low: 332,
                                                    high: 333,
                                                ),
                                            )),
                                        ],
                                        type_arguments: [],
                                    )),
                                )),
                            ],
                            unhappy_path: None,
                        )),
                    ],
                )),
                Expr((
                    span: (
                        low: 353,
                        high: 378,
                    ),
                    expr: Call((
                        span: (
                            low: 353,
                            high: 377,
                        ),
                        callee: Reference((
                            span: (
                                low: 353,
                                high: 357,
                            ),
                            name: (
                                name: "swap",
                                span: (
                                    low: 353,
                                    high: 357,
                                ),
                            ),
                        )),
                        arguments: [
                            UnaryOp((
                                span: (
                                    low: 358,
                                    high: 368,
                                ),
                                operand: BracketIndex((
                                    span: (
                                        low: 359,
                                        high: 368,
                                    ),
                                    origin: Reference((
                                        span: (
                                            low: 359,
                                            high: 361,
                                        ),
                                        name: (
                                            name: "xs",
                                            span: (
                                                low: 359,
                                                high: 361,
                                            ),
                                        ),
                                    )),
                                    index: BinaryOp((
                                        span: (
                                            low: 362,
                                            high: 367,
                                        ),
                                        lhs: Reference((
                                            span: (
                                                low: 362,
                                                high: 363,
                                            ),
                                            name: (
                                                name: "i",
                                                span: (
                                                    low: 362,
                                                    high: 363,
                                                ),
                                            ),
                                        )),
                                        rhs: IntegerLiteral((
                                            span: (
                                                low: 366,
                                                high: 367,
                                            ),
                                            value: 1,
                                        )),
                                        op: Add,
                                        op_span: (
                                            low: 364,
                                            high: 365,
                                        ),
                                    )),
                                )),
                                op: AddressOf,
                                op_span: (
                                    low: 358,
                                    high: 359,
                                ),
                            )),
                            UnaryOp((
                                span: (
                                    low: 370,
                                    high: 376,
                                ),
                                operand: BracketIndex((
                                    span: (
                                        low: 371,
                                        high: 376,
                                    ),
                                    origin: Reference((
                                        span: (
                                            low: 371,
                                            high: 373,
                                        ),
                                        name: (
                                            name: "xs",
                                            span: (
                                                low: 371,
                                                high: 373,
                                            ),
                                        ),
                                    )),
                                    index: Reference((
                                        span: (
                                            low: 374,
                                            high: 375,
                                        ),
                                        name: (
                                            name: "r",
                                            span: (
                                                low: 374,
                                                high: 375,
                                            ),
                                        ),
                                    )),
                                )),
                                op: AddressOf,
                                op_span: (
                                    low: 370,
                                    high: 371,
                                ),
                            )),
                        ],
                        type_arguments: [],
                    )),
                )),
                Return((
                    span: (
                        low: 381,
                        high: 394,
                    ),
                    value: Some(BinaryOp((
                        span: (
                            low: 388,
                            high: 393,
                        ),
                        lhs: Reference((
                            span: (
                                low: 388,
                                high: 389,
                            ),
                            name: (
                                name: "i",
                                span: (
                                    low: 388,
                                    high: 389,
                                ),
                            ),
                        )),
                        rhs: IntegerLiteral((
                            span: (
                                low: 392,
                                high: 393,
                            ),
                            value: 1,
                        )),
                        op: Add,
                        op_span: (
                            low: 390,
                            high: 391,
                        ),
                    ))),
                )),
            ],
        )),
        Function((
            span: (
                low: 398,
                high: 466,
            ),
            name: (
                name: "swap",
                span: (
                    low: 401,
                    high: 405,
                ),
            ),
            parameters: [
                (
                    span: (
                        low: 406,
                        high: 413,
                    ),
                    name: (
                        name: "a",
                        span: (
                            low: 406,
                            high: 407,
                        ),
                    ),
                    ty: Pointer((
                        span: (
                            low: 409,
                            high: 413,
                        ),
                        inner: Integer32((
                            span: (
                                low: 410,
                                high: 413,
                            ),
                        )),
                    )),
                ),
                (
                    span: (
                        low: 415,
                        high: 422,
                    ),
                    name: (
                        name: "b",
                        span: (
                            low: 415,
                            high: 416,
                        ),
                    ),
                    ty: Pointer((
                        span: (
                            low: 418,
                            high: 422,
                        ),
                        inner: Integer32((
                            span: (
                                low: 419,
                                high: 422,
                            ),
                        )),
                    )),
                ),
            ],
            type_parameters: [],
            return_type: None,
            body: [
                Let((
                    span: (
                        low: 428,
                        high: 441,
                    ),
                    name: (
                        name: "tmp",
                        span: (
                            low: 432,
                            high: 435,
                        ),
                    ),
                    ty: None,
                    value: UnaryOp((
                        span: (
                            low: 438,
                            high: 440,
                        ),
                        operand: Reference((
                            span: (
                                low: 439,
                                high: 440,
                            ),
                            name: (
                                name: "a",
                                span: (
                                    low: 439,
                                    high: 440,
                                ),
                            ),
                        )),
                        op: Deref,
                        op_span: (
                            low: 438,
                            high: 439,
                        ),
                    )),
                )),
                Expr((
                    span: (
                        low: 444,
                        high: 452,
                    ),
                    expr: Assign((
                        span: (
                            low: 444,
                            high: 451,
                        ),
                        lhs: UnaryOp((
                            span: (
                                low: 444,
                                high: 446,
                            ),
                            operand: Reference((
                                span: (
                                    low: 445,
                                    high: 446,
                                ),
                                name: (
                                    name: "a",
                                    span: (
                                        low: 445,
                                        high: 446,
                                    ),
                                ),
                            )),
                            op: Deref,
                            op_span: (
                                low: 444,
                                high: 445,
                            ),
                        )),
                        rhs: UnaryOp((
                            span: (
                                low: 449,
                                high: 451,
                            ),
                            operand: Reference((
                                span: (
                                    low: 450,
                                    high: 451,
                                ),
                                name: (
                                    name: "b",
                                    span: (
                                        low: 450,
                                        high: 451,
                                    ),
                                ),
                            )),
                            op: Deref,
                            op_span: (
                                low: 449,
                                high: 450,
                            ),
                        )),
                    )),
                )),
                Expr((
                    span: (
                        low: 455,
                        high: 464,
                    ),
                    expr: Assign((
                        span: (
                            low: 455,
                            high: 463,
                        ),
                        lhs: UnaryOp((
                            span: (
                                low: 455,
                                high: 457,
                            ),
                            operand: Reference((
                                span: (
                                    low: 456,
                                    high: 457,
                                ),
                                name: (
                                    name: "b",
                                    span: (
                                        low: 456,
                                        high: 457,
                                    ),
                                ),
                            )),
                            op: Deref,
                            op_span: (
                                low: 455,
                                high: 456,
                            ),
                        )),
                        rhs: Reference((
                            span: (
                                low: 460,
                                high: 463,
                            ),
                            name: (
                                name: "tmp",
                                span: (
                                    low: 460,
                                    high: 463,
                                ),
                            ),
                        )),
                    )),
                )),
            ],
        )),
    ],
)

----- stderr -----
Error: sema::trait_does_not_exist

  × trait Sub does not exist
    ╭─[tests/syntax/quicksort.test:11:11]
 10 │   let x = xs[r];
 11 │   let i = l - 1;
    ·           ──┬──
    ·             ╰── required trait Sub to exist
 12 │   for (let j = l; j < r; j = j + 1) {
    ╰────
